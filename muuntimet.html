<!DOCTYPE html>
<html lang="fi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MK Muuntimet</title>
    <style>
        /* MK Muuntimet, Versio 2.8 - Korjattu mobiiliasettelu ja alustusbugi */
        :root {
            --color-bg: #212529; --color-surface: #343A40; --color-card: #495057; 
            --color-border: #6c757d; --color-text-primary: #F8F9FA; --color-text-secondary: #adb5bd; 
            --color-accent-green: #90EE90; --color-accent-yellow: #FFD700; --color-accent-blue: #0d6efd;
        }
        body {
            background-color: var(--color-bg);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            margin: 0; padding: 20px;
            color: var(--color-text-primary);
        }
        .sisalto-laatikko { max-width: 700px; margin: 30px auto; padding: 10px; background-color: var(--color-surface); border: 1px solid var(--color-border); border-radius: 16px; box-shadow: 0 8px 30px rgba(0,0,0,0.2); }
        .teksti-alue { padding: 10px; }
        .header-flex-container { display: flex; align-items: center; gap: 15px; padding-bottom: 10px; justify-content: center; }
        .logo { width: 80px; height: 80px; border: 3px solid var(--color-border); border-radius: 50%; }
        .paaotsikko { color: var(--color-accent-green); text-align: center; margin: 0; font-size: 1.8em; font-weight: 300; }
        .huomio-laatikko { background-color: var(--color-card); padding: 20px; border-radius: 12px; margin-top: 20px; text-align: center; border: 1px solid var(--color-border); }
        .huomio-otsikko { color: var(--color-accent-yellow); font-weight: 500; margin: 0 0 20px 0; font-size: 1.1em; letter-spacing: 0.5px; }
        .valilehdet { display: flex; border-bottom: 1px solid var(--color-border); margin-bottom: 20px; flex-wrap: wrap; }
        .valilehti-nappi { background: none; border: none; color: var(--color-text-secondary); padding: 10px 15px; cursor: pointer; font-size: 0.9em; font-weight: 500; border-bottom: 3px solid transparent; transition: all 0.2s ease; }
        .valilehti-nappi:hover { color: var(--color-text-primary); }
        .valilehti-nappi.aktiivinen { color: var(--color-accent-yellow); border-bottom-color: var(--color-accent-yellow); }
        .valilehti-paneeli { display: none; padding: 10px; }
        .valilehti-paneeli.aktiivinen { display: block; animation: fadein 0.5s; }
        @keyframes fadein { from { opacity: 0; } to { opacity: 1; } }
        .muunnin-ryhma { margin-bottom: 25px; }
        .muunnin-ryhma label { display: block; text-align: left; font-size: 0.9em; color: var(--color-text-secondary); margin-bottom: 8px; }
        .muunnin-ryhma input, .muunnin-ryhma select {
            width: 100%; box-sizing: border-box; padding: 12px;
            background-color: var(--color-bg); border: 1px solid var(--color-border);
            color: var(--color-text-primary); border-radius: 8px;
            font-family: monospace; font-size: 1em; transition: all 0.2s ease;
        }
        .muunnin-ryhma input:focus, .muunnin-ryhma select:focus {
            outline: none; border-color: var(--color-accent-yellow);
            box-shadow: 0 0 0 3px color-mix(in srgb, var(--color-accent-yellow) 25%, transparent);
        }
        .yksikko-muunnin { display: grid; grid-template-columns: 1fr auto 1fr; gap: 10px; align-items: center; }
        .yksikko-muunnin .nuoli { font-size: 1.5em; color: var(--color-text-secondary); }
        .aika-tulos-laatikko { margin-top: 20px; text-align: left; }
        .aika-tulos-laatikko p { margin: 8px 0; background-color: var(--color-bg); padding: 10px; border-radius: 6px; }
        .aika-tulos-laatikko strong { color: var(--color-accent-yellow); }
        .mobiili-nav-container { display: none; margin-bottom: 20px; }
        #mobiili-nav { width: 100%; padding: 12px; background-color: var(--color-card); color: var(--color-text-primary); border: 1px solid var(--color-border); border-radius: 8px; font-size: 1em; }
        
        @media screen and (max-width: 800px) {
            body { padding: 5px; }
            .sisalto-laatikko { margin: 10px auto; }
            .paaotsikko { font-size: 1.5em; }
            .logo { width: 60px; height: 60px; }
            .valilehdet { display: none; }
            .mobiili-nav-container { display: block; }
            .yksikko-muunnin { grid-template-columns: 1fr; }
            .yksikko-muunnin .nuoli { transform: rotate(90deg); margin: 5px 0; }
        }
    </style>
</head>
<body>
    <div class="sisalto-laatikko">
        <div class="teksti-alue">
            <div class="header-flex-container">
                <div class="logo-container">
                    <img src="https://img.geocaching.com:443/84454fa6-e23a-4aad-a8a4-612b77f23abe.png" alt="Oma logo" class="logo" />
                </div>
                <h3 class="paaotsikko">MK Muuntimet</h3>
            </div>

            <div class="huomio-laatikko" style="padding: 0;">
                <div class="valilehdet">
                    <button class="valilehti-nappi aktiivinen" data-valilehti="koordinaatit">Koordinaatit</button>
                    <button class="valilehti-nappi" data-valilehti="pituus">Pituus</button>
                    <button class="valilehti-nappi" data-valilehti="nopeus">Nopeus</button>
                    <button class="valilehti-nappi" data-valilehti="aika">Aika</button>
                    <button class="valilehti-nappi" data-valilehti="massa">Massa</button>
                    <button class="valilehti-nappi" data-valilehti="lampotila">Lämpötila</button>
                    <button class="valilehti-nappi" data-valilehti="pinta-ala">Pinta-ala</button>
                    <button class="valilehti-nappi" data-valilehti="tilavuus">Tilavuus</button>
                    <button class="valilehti-nappi" data-valilehti="paine">Paine</button>
                    <button class="valilehti-nappi" data-valilehti="energia">Energia</button>
                    <button class="valilehti-nappi" data-valilehti="teho">Teho</button>
                    <button class="valilehti-nappi" data-valilehti="data">Data</button>
                    <button class="valilehti-nappi" data-valilehti="kulma">Kulma</button>
                    <button class="valilehti-nappi" data-valilehti="roomalaiset">Roomalaiset</button>
                    <button class="valilehti-nappi" data-valilehti="luvut">Lukujärjestelmät</button>
                </div>
                
                <div class="mobiili-nav-container">
                    <select id="mobiili-nav"></select>
                </div>

                <div class="valilehti-sisalto">
                    <div id="koordinaatit" class="valilehti-paneeli aktiivinen"></div>
                    <div id="aika" class="valilehti-paneeli"></div>
                    <div id="pituus" class="valilehti-paneeli"></div>
                    <div id="nopeus" class="valilehti-paneeli"></div>
                    <div id="massa" class="valilehti-paneeli"></div>
                    <div id="lampotila" class="valilehti-paneeli"></div>
                    <div id="pinta-ala" class="valilehti-paneeli"></div>
                    <div id="tilavuus" class="valilehti-paneeli"></div>
                    <div id="paine" class="valilehti-paneeli"></div>
                    <div id="energia" class="valilehti-paneeli"></div>
                    <div id="teho" class="valilehti-paneeli"></div>
                    <div id="data" class="valilehti-paneeli"></div>
                    <div id="kulma" class="valilehti-paneeli"></div>
                    <div id="roomalaiset" class="valilehti-paneeli"></div>
                    <div id="luvut" class="valilehti-paneeli"></div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
    /*
      MK MUUNTIMET
      Versio 2.8 - Kriittinen korjaus muuntimien alustukseen
    */
    document.addEventListener('DOMContentLoaded', () => {
        // --- VÄLILEHTIEN LOGIIKKA ---
        const valilehtiContainer = document.querySelector('.valilehdet');
        const valilehtiPaneelit = document.querySelectorAll('.valilehti-paneeli');
        const mobiiliNav = document.getElementById('mobiili-nav');
        
        const vaihdaValilehtea = (kohde) => {
            valilehtiContainer.querySelectorAll('.valilehti-nappi').forEach(nappi => {
                nappi.classList.toggle('aktiivinen', nappi.dataset.valilehti === kohde);
            });
            valilehtiPaneelit.forEach(paneeli => {
                paneeli.classList.toggle('aktiivinen', paneeli.id === kohde);
            });
            if (mobiiliNav.value !== kohde) {
                mobiiliNav.value = kohde;
            }
        };

        valilehtiContainer.addEventListener('click', (e) => {
            const klikattuNappi = e.target.closest('.valilehti-nappi');
            if (klikattuNappi) {
                vaihdaValilehtea(klikattuNappi.dataset.valilehti);
            }
        });

        mobiiliNav.addEventListener('change', (e) => {
            vaihdaValilehtea(e.target.value);
        });

        valilehtiContainer.querySelectorAll('.valilehti-nappi').forEach(nappi => {
            const option = new Option(nappi.textContent, nappi.dataset.valilehti);
            mobiiliNav.add(option);
        });
        
        const alustaKoordinaattiMuunnin = () => {
            const container = document.getElementById('koordinaatit');
            container.innerHTML = `<div class="muunnin-ryhma"><label for="dd-input">Desimaaliasteet (DD)</label><input type="text" id="dd-input" placeholder="esim. 60.9814, 25.6601"></div><div class="muunnin-ryhma"><label for="ddm-input">Asteet & Desimaaliminuutit (DDM)</label><input type="text" id="ddm-input" placeholder="esim. N 60° 58.884' E 025° 39.606'"></div><div class="muunnin-ryhma"><label for="dms-input">Asteet, Minuutit & Sekunnit (DMS)</label><input type="text" id="dms-input" placeholder="esim. 60°58'53.0&quot;N 25°39'36.4&quot;E"></div>`;
            const ddInput = document.getElementById('dd-input'), ddmInput = document.getElementById('ddm-input'), dmsInput = document.getElementById('dms-input');
            const paivitaKoordinaatit = (lat, lon, source) => { if (isNaN(lat) || isNaN(lon)) return; if (source !== 'dd') ddInput.value = `${lat.toFixed(6)}, ${lon.toFixed(6)}`; if (source !== 'ddm') ddmInput.value = muotoileDDM(lat, lon); if (source !== 'dms') dmsInput.value = muotoileDMS(lat, lon); };
            const kasittele = (e) => { const coords = parseKoordinaatit(e.target.value); if (coords) paivitaKoordinaatit(coords.lat, coords.lon, e.target.id.split('-')[0]); };
            [ddInput, ddmInput, dmsInput].forEach(input => input.addEventListener('input', kasittele));
            const parseKoordinaatit = (input) => {
                input = input.trim();
                const dmsRegex = /(\d{1,3})[°\s]+(\d{1,2})['\s]+([\d\.]+)"?\s*([ns])[\s,]+(\d{1,3})[°\s]+(\d{1,2})['\s]+([\d\.]+)"?\s*([ew])/i;
                const dmsMatch = input.match(dmsRegex); if (dmsMatch) { let lat = parseFloat(dmsMatch[1]) + parseFloat(dmsMatch[2])/60 + parseFloat(dmsMatch[3])/3600; if(dmsMatch[4].toUpperCase()==='S') lat=-lat; let lon = parseFloat(dmsMatch[5]) + parseFloat(dmsMatch[6])/60 + parseFloat(dmsMatch[7])/3600; if(dmsMatch[8].toUpperCase()==='W') lon=-lon; if(!isNaN(lat)&&!isNaN(lon)) return {lat,lon};}
                const ddmRegex = /([ns])\s*(\d{1,3})[°\s]+([\d.]+)'?[\s,]*([ew])\s*(\d{1,3})[°\s]+([\d.]+)'?/i;
                const ddmMatch = input.match(ddmRegex); if (ddmMatch) { let lat = parseFloat(ddmMatch[2]) + parseFloat(ddmMatch[3])/60; if(ddmMatch[1].toUpperCase()==='S') lat=-lat; let lon = parseFloat(ddmMatch[5]) + parseFloat(ddmMatch[6])/60; if(ddmMatch[4].toUpperCase()==='W') lon=-lon; if(!isNaN(lat)&&!isNaN(lon)) return {lat,lon};}
                const parts = input.replace(/,/g, ' ').split(/\s+/).filter(Boolean); if (parts.length === 2) { const lat = parseFloat(parts[0]), lon = parseFloat(parts[1]); if(!isNaN(lat)&&!isNaN(lon)) return {lat,lon};} return null;
            };
            const muotoileDDM = (lat, lon) => { const f = (v,h1,h2) => `${v>=0?h1:h2} ${Math.floor(Math.abs(v))}° ${((Math.abs(v)-Math.floor(Math.abs(v)))*60).toFixed(3)}'`; return `${f(lat,'N','S')} ${f(lon,'E','W')}`; };
            const muotoileDMS = (lat, lon) => { const f = (v,h1,h2) => { const deg=Math.floor(Math.abs(v)), min=Math.floor((Math.abs(v)-deg)*60), sec=(((Math.abs(v)-deg)*60-min)*60).toFixed(1); return `${deg}°${min}'${sec}"${v>=0?h1:h2}`; }; return `${f(lat,'N','S')} ${f(lon,'E','W')}`; };
        };

        const yksikot = {
            pituus: [ { sym: 'mm', name: 'Millimetri', kerroin: 0.001 }, { sym: 'cm', name: 'Senttimetri', kerroin: 0.01 }, { sym: 'm', name: 'Metri', kerroin: 1 }, { sym: 'km', name: 'Kilometri', kerroin: 1000 }, { sym: 'in', name: 'Tuuma', kerroin: 0.0254 }, { sym: 'ft', name: 'Jalka', kerroin: 0.3048 }, { sym: 'yd', name: 'Jaardi', kerroin: 0.9144 }, { sym: 'mi', name: 'Maili', kerroin: 1609.34 }, { sym: 'nmi', name: 'Meripeninkulma', kerroin: 1852 }, { sym: 'fur', name: 'Virsta (furlong)', kerroin: 201.168 }, { sym: 'kyynärä', name: 'Kyynärä (vanha)', kerroin: 0.594 }, { sym: 'peninkulma', name: 'Peninkulma (vanha)', kerroin: 10688 } ],
            massa: [ { sym: 'mg', name: 'Milligramma', kerroin: 0.001 }, { sym: 'g', name: 'Gramma', kerroin: 1 }, { sym: 'kg', name: 'Kilogramma', kerroin: 1000 }, { sym: 't', name: 'Tonni', kerroin: 1000000 }, { sym: 'oz', name: 'Unssi', kerroin: 28.3495 }, { sym: 'lb', name: 'Naula (pauna)', kerroin: 453.592 }, { sym: 'st', name: 'Stone', kerroin: 6350.29 }, { sym: 'ct', name: 'Karaatti', kerroin: 0.2 } ],
            nopeus: [ { sym: 'm/s', name: 'Metriä/s', kerroin: 1 }, { sym: 'km/h', name: 'Kilometriä/h', kerroin: 1 / 3.6 }, { sym: 'mph', name: 'Mailia/h', kerroin: 0.44704 }, { sym: 'kn', name: 'Solmu', kerroin: 0.514444 } ],
            aika: [ { sym: 'ms', name: 'Millisekunti', plural: 'Millisekunteina', kerroin: 0.001 }, { sym: 's', name: 'Sekunti', plural: 'Sekunteina', kerroin: 1 }, { sym: 'min', name: 'Minuutti', plural: 'Minuutteina', kerroin: 60 }, { sym: 'h', name: 'Tunti', plural: 'Tunteina', kerroin: 3600 }, { sym: 'd', name: 'Päivä', plural: 'Päivinä', kerroin: 86400 }, { sym: 'vk', name: 'Viikko', plural: 'Viikkoina', kerroin: 604800 }, { sym: 'a', name: 'Vuosi (noin)', plural: 'Vuosina', kerroin: 31557600 } ],
            pinta_ala: [ { sym: 'mm²', name: 'Neliömillimetri', kerroin: 0.000001 }, { sym: 'cm²', name: 'Neliösenttimetri', kerroin: 0.0001 }, { sym: 'm²', name: 'Neliömetri', kerroin: 1 }, { sym: 'a', name: 'Aari', kerroin: 100 }, { sym: 'ha', name: 'Hehtaari', kerroin: 10000 }, { sym: 'km²', name: 'Neliökilometri', kerroin: 1000000 }, { sym: 'in²', name: 'Neliötuuma', kerroin: 0.00064516 }, { sym: 'ft²', name: 'Neliöjalka', kerroin: 0.092903 }, { sym: 'ac', name: 'Eekkeri', kerroin: 4046.86 } ],
            tilavuus: [ { sym: 'ml', name: 'Millilitra', kerroin: 0.001 }, { sym: 'cl', name: 'Senttilitra', kerroin: 0.01 }, { sym: 'dl', name: 'Desilitra', kerroin: 0.1 }, { sym: 'l', name: 'Litra', kerroin: 1 }, { sym: 'm³', name: 'Kuutiometri', kerroin: 1000 }, { sym: 'fl oz', name: 'Nesteunssi (US)', kerroin: 0.0295735 }, { sym: 'gal', name: 'Gallona (US)', kerroin: 3.78541 } ],
            paine: [ { sym: 'Pa', name: 'Pascal', kerroin: 1 }, { sym: 'kPa', name: 'Kilopascal', kerroin: 1000 }, { sym: 'bar', name: 'Baari', kerroin: 100000 }, { sym: 'atm', name: 'Ilmakehä', kerroin: 101325 }, { sym: 'psi', name: 'PSI', kerroin: 6894.76 } ],
            energia: [ { sym: 'J', name: 'Joule', kerroin: 1 }, { sym: 'kJ', name: 'Kilojoule', kerroin: 1000 }, { sym: 'cal', name: 'Kalori', kerroin: 4.184 }, { sym: 'kcal', name: 'Kilokalori', kerroin: 4184 }, { sym: 'kWh', name: 'Kilowattitunti', kerroin: 3600000 } ],
            teho: [ { sym: 'W', name: 'Watti', kerroin: 1 }, { sym: 'kW', name: 'Kilowatti', kerroin: 1000 }, { sym: 'MW', name: 'Megawatti', kerroin: 1000000 }, { sym: 'hp', name: 'Hevosvoima', kerroin: 745.7 } ],
            data: [ { sym: 'B', name: 'Tavu', kerroin: 1 }, { sym: 'KiB', name: 'Kilotavu (KiB)', kerroin: 1024 }, { sym: 'MiB', name: 'Megatavu (MiB)', kerroin: 1024**2 }, { sym: 'GiB', name: 'Gigatavu (GiB)', kerroin: 1024**3 }, { sym: 'TiB', name: 'Teratavu (TiB)', kerroin: 1024**4 } ],
            kulma: [ { sym: 'deg', name: 'Aste', kerroin: 1 }, { sym: 'rad', name: 'Radiaani', kerroin: 57.2958 }, { sym: 'grad', name: 'Gooni', kerroin: 0.9 }, { sym: 'rev', name: 'Kierros', kerroin: 360 } ]
        };

        const luoVakioMuunninHTML = (id) => `<div class="yksikko-muunnin"><div><label for="${id}-arvo">Arvo</label><input type="number" id="${id}-arvo" value="1"></div><div></div><div><label for="${id}-tulos">Tulos</label><input type="text" id="${id}-tulos" readonly></div><div><label for="${id}-yksikko-mista">Mistä</label><select id="${id}-yksikko-mista"></select></div><div class="nuoli">&rarr;</div><div><label for="${id}-yksikko-mihin">Mihin</label><select id="${id}-yksikko-mihin"></select></div></div>`;
        
        const alustaVakioMuunnin = (id, yksikkoData) => {
            document.getElementById(id).innerHTML = luoVakioMuunninHTML(id);
            const arvoInput = document.getElementById(`${id}-arvo`);
            const tulosInput = document.getElementById(`${id}-tulos`);
            const mistaSelect = document.getElementById(`${id}-yksikko-mista`);
            const mihinSelect = document.getElementById(`${id}-yksikko-mihin`);
            yksikkoData.forEach(yksikko => {
                const teksti = `${yksikko.name} (${yksikko.sym})`;
                mistaSelect.add(new Option(teksti, yksikko.sym));
                mihinSelect.add(new Option(teksti, yksikko.sym));
            });
            mistaSelect.selectedIndex = 1; 
            if (yksikkoData.length > 2) mihinSelect.selectedIndex = 2;
            const laske = () => {
                const arvo = parseFloat(arvoInput.value) || 0;
                const mistaKerroin = yksikkoData.find(y => y.sym === mistaSelect.value)?.kerroin || 1;
                const mihinKerroin = yksikkoData.find(y => y.sym === mihinSelect.value)?.kerroin || 1;
                const tulos = arvo * mistaKerroin / mihinKerroin;
                tulosInput.value = tulos.toLocaleString('fi-FI', { maximumFractionDigits: 6 });
            };
            arvoInput.addEventListener('input', laske);
            mistaSelect.addEventListener('change', laske);
            mihinSelect.addEventListener('change', laske);
            laske();
        };
        
        const alustaLampotilaMuunnin = () => {
            document.getElementById('lampotila').innerHTML = luoVakioMuunninHTML('lampotila');
            const arvoInput = document.getElementById('lampotila-arvo');
            const tulosInput = document.getElementById('lampotila-tulos');
            const mistaSelect = document.getElementById('lampotila-yksikko-mista');
            const mihinSelect = document.getElementById('lampotila-yksikko-mihin');
            ['Celsius', 'Fahrenheit', 'Kelvin'].forEach(key => { mistaSelect.add(new Option(key, key)); mihinSelect.add(new Option(key, key)); });
            mihinSelect.value = 'Fahrenheit';
            const laske = () => {
                let arvo = parseFloat(arvoInput.value) || 0; let tulos;
                if (mistaSelect.value === 'Fahrenheit') arvo = (arvo - 32) * 5/9;
                else if (mistaSelect.value === 'Kelvin') arvo = arvo - 273.15;
                if (mihinSelect.value === 'Celsius') tulos = arvo;
                else if (mihinSelect.value === 'Fahrenheit') tulos = arvo * 9/5 + 32;
                else if (mihinSelect.value === 'Kelvin') tulos = arvo + 273.15;
                tulosInput.value = tulos.toLocaleString('fi-FI', { maximumFractionDigits: 2 });
            };
            arvoInput.addEventListener('input', laske);
            mistaSelect.addEventListener('change', laske);
            mihinSelect.addEventListener('change', laske);
            laske();
        };

        const alustaAikaMuunnin = () => {
            const container = document.getElementById('aika');
            container.innerHTML = `<div class="yksikko-muunnin"><div><label for="aika-arvo">Arvo</label><input type="number" id="aika-arvo" value="1"></div><div></div><div><label for="aika-yksikko-mista">Yksikkö</label><select id="aika-yksikko-mista"></select></div></div><div id="aika-tulokset" class="aika-tulos-laatikko"></div>`;
            const arvoInput = document.getElementById('aika-arvo');
            const yksikkoSelect = document.getElementById('aika-yksikko-mista');
            const tuloksetDiv = document.getElementById('aika-tulokset');
            yksikot.aika.forEach(y => yksikkoSelect.add(new Option(`${y.name} (${y.sym})`, y.sym)));
            yksikkoSelect.value = 'h';
            const laske = () => {
                const arvo = parseFloat(arvoInput.value) || 0;
                const mistaKerroin = yksikot.aika.find(y => y.sym === yksikkoSelect.value)?.kerroin || 1;
                const sekunteina = arvo * mistaKerroin;
                let html = '<p><strong>Muunnos:</strong></p>';
                const d = Math.floor(sekunteina / 86400); const h = Math.floor((sekunteina % 86400) / 3600);
                const m = Math.floor((sekunteina % 3600) / 60); const s = sekunteina % 60;
                html += `<p><strong>Yhteensä:</strong> ${d} pv, ${h} h, ${m} min ja ${s.toFixed(1)} s</p><hr>`;
                yksikot.aika.slice().reverse().forEach(y => {
                    html += `<p><strong>${y.plural}:</strong> ${(sekunteina / y.kerroin).toLocaleString('fi-FI', { maximumFractionDigits: 4 })} ${y.sym}</p>`;
                });
                tuloksetDiv.innerHTML = html;
            };
            arvoInput.addEventListener('input', laske);
            yksikkoSelect.addEventListener('change', laske);
            laske();
        };

        const alustaLukujarjestelmaMuunnin = () => {
            const container = document.getElementById('luvut');
            container.innerHTML = `
                <div class="muunnin-ryhma"><label for="luku-dec">Desimaali (10)</label><input type="number" id="luku-dec" placeholder="esim. 42"></div>
                <div class="muunnin-ryhma"><label for="luku-bin">Binääri (2)</label><input type="text" id="luku-bin" placeholder="esim. 101010"></div>
                <div class="muunnin-ryhma"><label for="luku-oct">Oktaali (8)</label><input type="text" id="luku-oct" placeholder="esim. 52"></div>
                <div class="muunnin-ryhma"><label for="luku-hex">Heksadesimaali (16)</label><input type="text" id="luku-hex" placeholder="esim. 2A"></div>`;
            const inputs = { dec: 10, bin: 2, oct: 8, hex: 16 };
            Object.keys(inputs).forEach(key => {
                document.getElementById(`luku-${key}`).addEventListener('input', (e) => {
                    const arvo = e.target.value; if (arvo === '') return;
                    const pohja = inputs[key]; const desimaaliArvo = parseInt(arvo, pohja);
                    if (isNaN(desimaaliArvo)) return;
                    Object.keys(inputs).forEach(otherKey => {
                        if (key !== otherKey) document.getElementById(`luku-${otherKey}`).value = desimaaliArvo.toString(inputs[otherKey]).toUpperCase();
                    });
                });
            });
        };
        
        const alustaRoomalainenMuunnin = () => {
            const container = document.getElementById('roomalaiset');
            container.innerHTML = `<div class="yksikko-muunnin">
                <div><label for="rooma-arabialainen">Numero</label><input type="number" id="rooma-arabialainen" placeholder="esim. 1984"></div>
                <div class="nuoli">&harr;</div>
                <div><label for="rooma-roomalainen">Roomalainen numero</label><input type="text" id="rooma-roomalainen" placeholder="esim. MCMLXXXIV"></div>
            </div>`;
            const arabInput = document.getElementById('rooma-arabialainen'), roomaInput = document.getElementById('rooma-roomalainen');
            const arabToRoman = (num) => { if (isNaN(num) || num < 1 || num > 3999) return ''; const map = { M: 1000, CM: 900, D: 500, CD: 400, C: 100, XC: 90, L: 50, XL: 40, X: 10, IX: 9, V: 5, IV: 4, I: 1 }; let r = ''; for (let k in map) { while (num >= map[k]) { r += k; num -= map[k]; } } return r; };
            const romanToArab = (str) => { str = str.toUpperCase(); const map = { I: 1, V: 5, X: 10, L: 50, C: 100, D: 500, M: 1000 }; let r = 0; for (let i = 0; i < str.length; i++) { const c = map[str[i]], n = map[str[i + 1]]; if (c < n) r -= c; else r += c; } return isNaN(r) || r > 3999 ? '' : r; };
            arabInput.addEventListener('input', () => roomaInput.value = arabToRoman(parseInt(arabInput.value)));
            roomaInput.addEventListener('input', () => arabInput.value = romanToArab(roomaInput.value));
        };

        // Alustetaan kaikki muuntimet
        alustaKoordinaattiMuunnin();
        Object.keys(yksikot).forEach(key => { if(key !== 'aika') alustaVakioMuunnin(key, yksikot[key]); });
        alustaLampotilaMuunnin();
        alustaAikaMuunnin();
        alustaLukujarjestelmaMuunnin();
        alustaRoomalainenMuunnin();
    });
    </script>
</body>
</html>
